<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== #29. mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ==== #29. 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="ansehyeong">
	
	
	<!-- // 메인 화면에 뜨는 배너 광고를 올려준다. -->
	<select id="getBannerList" resultType="com.project.skyuniversity.ash.model.BannerVO">
		select ino, iname, ilink, status
	    from tbl_an_index_img
	    where status = 1
	</select>
	
	
	<!-- // 로그인 하는 경우 한명의 회원을 불러오기 -->
	<select id="getLoginUser" resultType="com.project.skyuniversity.ash.model.CommuMemberVO" parameterType="HashMap">
		select commuMemberNo, fk_memberNo, fk_levelNo, nickname, point, m.name, m.email
		from tbl_commu_member c
		join
			(select memberno, name, email
			from tbl_member
			where memberno = #{id} and pwd = #{pwd}
		) m
		on c.fk_memberNo = m.memberno
	
	</select>
	
	<!-- 로그인 한 유저의 등급정보를 알아오기!! -->
	<select id="getLoginUserLevel" resultType="com.project.skyuniversity.ash.model.CommuMemberLevelVO" parameterType="com.project.skyuniversity.ash.model.CommuMemberVO">
		select levelno, levelName, levelPoint, levelImg
		from tbl_commu_member_level
		where levelNo = ${fk_levelNo}
	</select>
	
	
	<!-- 닉넴 업뎃 요청한 놈 요청 들어주기 -->
	<update id="updateNicknameEnd" parameterType="HashMap">
		update tbl_commu_member set nickname = #{nickname}
		where commuMemberNo = #{commuMemberNo}
	</update>
	
	<!-- // === 장터 게시판 리스트 페이지 요청시 카테고리 목록 가져오기=== // -->
	<select id="getCategoryList" parameterType="String" resultType="HashMap">
		select categoryNo, fk_boardKindNo, categoryName
		from tbl_category
		where fk_boardKindNo = #{boardKindNo}
	</select>
	
	
</mapper>